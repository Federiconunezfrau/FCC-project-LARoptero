/*
 * timeTriggeredUART.cpp
 *
 *  Created on: Feb 26, 2024
 *      Author: fede
 */

#include "timeTriggeredUART.h"
#include "myUtils.h"

#define MAX_LEN_PAYLOAD 32

void timeTriggeredUART_constructor(timeTriggeredUART_t *me, UART_HandleTypeDef huart, uint8_t bytesToSend)
{
	me->mHuart_ = huart;
	me->mBytesToSend_ = bytesToSend;
}

TTUART_status_t timeTriggeredUART_add_to_queue(timeTriggeredUART_t *me, uint8_t cmd, uint8_t lenPayload, uint8_t *payload )
{
	uint8_t buffer[MAX_LEN_PAYLOAD+2];

	if(lenPayload > MAX_LEN_PAYLOAD)
	{
		return TTUART_PAYLOAD_TOO_LONG;
	}

	buffer[0] = cmd;
	buffer[1] = lenPayload;
	my_copy_array_of_uint8(&buffer[2],payload, lenPayload);

	me->mBuffer_.copy_from(buffer, lenPayload+2);
}

TTUART_status_t timeTriggeredUART_send(timeTriggeredUART_t *me)
{

}

